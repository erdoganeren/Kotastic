<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Index Site </title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<script type="text/javascript" src="js/main.js"></script>
	<script type="text/javascript" src="js/positionMachine.js"></script>
	<script type="text/javascript" src="js/dogBagPoint.js"></script>
	<script type="text/javascript" src="js/dogBagManager.js"></script>
	<style>
		html,
		body,
		#map {
			height: 100%;
			margin: 0;
			padding: 0;
			width: 100%;
		}
	</style>

	<script src="https://maps.googleapis.com/maps/api/js"></script>
	<script src="https://rawgit.com/rcknr/basemap-google-maps/master/basemap-tiles.min.js"></script>


</head>
<h1>Kotastic</h1>
<br>
<input id="start" type="text" placeholder="Startpunk eingeben" >  <br>
<input id="end" type="text" placeholder="Endpunkt eingeben">
<br>
<br>

<div style="height: 400px; width: 600px;" >
	<div id="map" ></div>
</div>


<script>
	let map;
	let icons
	let features;

	function setMarker(features, map) {
		for (var i = 0; i < features.length; i++) {
			var marker = new google.maps.Marker({
				position: features[i].position,
				title: features[i].markerTitle,
				icon: icons[features[i].type].icon,
				map: map
			});

			marker.setMap(map);
		};
	}

	function initMap() {
		var directionsService = new google.maps.DirectionsService();
		var directionsRenderer = new google.maps.DirectionsRenderer();
		map = new google.maps.Map(document.getElementById('map'), {
			zoom: 20,
			center: new google.maps.LatLng(48.25113105446648, 16.501423166734703),
		});

		icons = {
			poop: { //TODO: Change to copyright free source
				icon: 'icons/poop.png'
			}};
		features = [
			{
				position: new google.maps.LatLng(48.25113105446648, 16.501423166734703),
				markerTitle: "First Marker",
				type: 'poop'
			},{
				position: new google.maps.LatLng(48.136903037435864, 16.397476311182015),
				markerTitle: "Second Marker",
				type: 'poop'
			},
		];
		new Basemap(map);
		directionsRenderer.setMap(map);

		var onChangeHandler = function() {
			calculateAndDisplayRoute(directionsService, directionsRenderer);
		};
		document.getElementById('start').addEventListener('change', onChangeHandler);
		document.getElementById('end').addEventListener('change', onChangeHandler);
		//setMarker(features, map);
	}

	function calculateAndDisplayRoute(directionsService, directionsRenderer) {
		directionsService.route(
				{
					origin: {query: document.getElementById('start').value},
					destination: {query: document.getElementById('end').value},
					travelMode: 'WALKING'
				},
				function(response, status) {
					if (status === 'OK') {
						directionsRenderer.setDirections(response);
					} else {
						window.alert('Directions request failed due to ' + status);
					}
				});
	}
</script>
<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJVeimfjlbj5zCPRn6DUk6w6B26tQe6HM&callback=initMap">
</script>
</html>